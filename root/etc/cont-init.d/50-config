#!/usr/bin/with-contenv bash

# make our folders and links
mkdir -p \
	/config/{log/spotweb,spotweb}

# copy spotweb retrieve file if not present in cron
[[ ! -f /etc/periodic/15min/retrieve.sh ]] && \
cp /defaults/retrieve.sh /etc/periodic/15min/retrieve.sh

# link spotweb retrieve file if not present in config
[[ ! -f /config/spotweb/retrieve.sh ]] && \
ln -s /etc/periodic/15min/retrieve.sh /config/spotweb/retrieve.sh

# logfiles needed by spotweb retrieve
[[ ! -f /config/log/spotweb/retrieve.log ]] && \
	touch /config/log/spotweb/retrieve.log

# permissions
chown -R abc:abc \
	/config
chmod -R 0644 /etc/logrotate.d
chmod -R +r /config/log
